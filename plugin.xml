<?xml version='1.0' encoding='utf-8'?>
<plugin id="powerednow-ai-plugin" version="1.0.0"
  xmlns="http://apache.org/cordova/ns/plugins/1.0"
  xmlns:ios="http://apache.org/cordova/ns/platforms/ios"
  xmlns:android="http://schemas.android.com/apk/res/android">

  <name>AIPlugin</name>
  <description>Minimal Swift-based Cordova plugin for AI demo</description>
  <license>MIT</license>
  <keywords>cordova, ios, swift, ai</keywords>

  <!-- JS bridge -->
  <js-module name="AI" src="www/ai.js">
    <clobbers target="AI" />
  </js-module>

  <platform name="ios">
    <config-file target="config.xml" parent="/*">
      <feature name="AIPlugin">
        <param name="ios-package" value="AIPlugin" />
        <!-- (opcionális) onload="true" ha betöltést akarsz induláskor -->
      </feature>
    </config-file>

    <!-- A plugin Swift forrása -->
    <source-file src="src/ios/AIPlugin.swift" />

    <!--framework
    src="AppleIntelligence.framework" type="system" weak="true" /-->
  </platform>

  <platform name="android">
    <config-file target="res/xml/config.xml" parent="/*">
      <feature name="AIPlugin">
        <param name="android-package" value="com.powerednow.ai.AIPlugin" />
      </feature>
      <preference name="GradlePluginKotlinEnabled" value="true" />
      <preference name="GradlePluginKotlinVersion" value="1.9.24" />
    </config-file>

    <config-file target="AndroidManifest.xml" parent="/manifest">
      <uses-permission android:name="android.permission.RECORD_AUDIO" />
    </config-file>

    <config-file target="AndroidManifest.xml" parent="/manifest/application">
      <uses-native-library android:name="libOpenCL.so" android:required="false" />
      <uses-native-library android:name="libOpenCL-car.so" android:required="false" />
      <uses-native-library android:name="libOpenCL-pixel.so" android:required="false" />
    </config-file>

    <source-file src="src/android/AIPlugin.kt" target-dir="app/src/main/java/com/powerednow/ai" />
    <source-file src="src/android/SpeechToTextManager.kt" target-dir="app/src/main/java/com/powerednow/ai" />
    <source-file src="src/android/TextToSpeechManager.kt" target-dir="app/src/main/java/com/powerednow/ai" />
    <source-file src="src/android/LlmManager.kt" target-dir="app/src/main/java/com/powerednow/ai" />

    <framework src="com.google.mediapipe:tasks-genai:0.10.24" />
    <framework src="com.google.ai.edge.localagents:localagents-fc:0.1.0" />
  </platform>
</plugin>